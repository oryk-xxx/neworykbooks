"use strict";(()=>{var e={};e.id=201,e.ids=[201],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7826:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>A,patchFetch:()=>d,requestAsyncStorage:()=>E,routeModule:()=>_,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{GET:()=>u});var o=r(9303),a=r(8716),n=r(670),i=r(7070),p=r(7848),c=r(748);async function u(e){let t=new URL(e.url).searchParams.get("id");if(!t)return i.NextResponse.json({error:"missing id"},{status:400});let r=await fetch(`https://api.mercadopago.com/v1/payments/${t}`,{headers:{Authorization:`Bearer ${p.O.mercadoPagoAccessToken}`},cache:"no-store"});if(!r.ok)return i.NextResponse.json({error:"mp error"},{status:500});let s=(await r.json()).status;if("approved"===s){let e=(0,c.i)();await e.from("entitlements").update({active:!0,updated_at:new Date().toISOString()}).eq("last_payment_id",t)}return i.NextResponse.json({status:s})}let _=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/payment/status/route",pathname:"/api/payment/status",filename:"route",bundlePath:"app/api/payment/status/route"},resolvedPagePath:"/home/oryk/Documentos/GitHub/neworykbooks/src/app/api/payment/status/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:E,staticGenerationAsyncStorage:l,serverHooks:m}=_,A="/api/payment/status/route";function d(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},7848:(e,t,r)=>{r.d(t,{O:()=>s});let s={siteUrl:process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000",supabaseUrl:process.env.NEXT_PUBLIC_SUPABASE_URL||"",supabaseAnonKey:process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",supabaseServiceRoleKey:process.env.SUPABASE_SERVICE_ROLE_KEY||"",mercadoPagoAccessToken:process.env.MERCADOPAGO_ACCESS_TOKEN||"",mercadoPagoWebhookSecret:process.env.MERCADOPAGO_WEBHOOK_SECRET||"",paymentAmount:Number(process.env.NEXT_PUBLIC_PAYMENT_AMOUNT||.8),originalAmount:Number(process.env.NEXT_PUBLIC_PAYMENT_ORIGINAL_AMOUNT||19)}},748:(e,t,r)=>{r.d(t,{i:()=>i,j:()=>n});var s=r(7721),o=r(1615),a=r(7857);function n(){let e=(0,o.cookies)();return(0,s.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:t=>e.get(t)?.value,set(t,r,s){try{e.set({name:t,value:r,...s})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}},auth:{flowType:"pkce"}})}function i(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL,t=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e||!t)throw Error("SUPABASE_SERVICE_ROLE_KEY ou URL n\xe3o configurados.");return(0,a.eI)(e,t,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,786,702,972],()=>r(7826));module.exports=s})();