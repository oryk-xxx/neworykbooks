"use strict";(()=>{var e={};e.id=53,e.ids=[53],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9906:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>k,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>_,staticGenerationAsyncStorage:()=>l});var o={};t.r(o),t.d(o,{POST:()=>c});var s=t(9303),a=t(8716),n=t(670),i=t(7070),d=t(1067),p=t(748);let u=d.Ry({slug:d.Z_().min(2),order_index:d.oQ.number().min(1),content_json:d.Z_().min(2)});async function c(e,r){let t=(0,p.j)(),o=await e.formData(),s=u.safeParse({slug:String(o.get("slug")||""),order_index:Number(o.get("order_index")||"1"),content_json:String(o.get("content_json")||"")});if(!s.success)return i.NextResponse.redirect(new URL(`/admin/books/${r.params.bookId}/pages/${r.params.pageId}?error=invalid`,e.url));let a=s.data,n=JSON.parse(a.content_json),{data:d,error:c}=await t.from("pages").update({slug:a.slug,order_index:a.order_index,content:n}).eq("id",r.params.pageId).select("*").maybeSingle();return!d||c?i.NextResponse.redirect(new URL(`/admin/books/${r.params.bookId}/pages/${r.params.pageId}?error=save_failed`,e.url)):(await t.from("page_versions").insert({page_id:d.id,content:n}),i.NextResponse.redirect(new URL(`/admin/books/${r.params.bookId}/pages/${r.params.pageId}`,e.url)))}let g=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/(protected)/admin/books/[bookId]/pages/[pageId]/save/route",pathname:"/admin/books/[bookId]/pages/[pageId]/save",filename:"route",bundlePath:"app/(protected)/admin/books/[bookId]/pages/[pageId]/save/route"},resolvedPagePath:"/home/oryk/Documentos/GitHub/neworykbooks/src/app/(protected)/admin/books/[bookId]/pages/[pageId]/save/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:_}=g,k="/(protected)/admin/books/[bookId]/pages/[pageId]/save/route";function v(){return(0,n.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:l})}},748:(e,r,t)=>{t.d(r,{i:()=>i,j:()=>n});var o=t(7721),s=t(1615),a=t(7857);function n(){let e=(0,s.cookies)();return(0,o.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:r=>e.get(r)?.value,set(r,t,o){try{e.set({name:r,value:t,...o})}catch(e){}},remove(r,t){try{e.set({name:r,value:"",...t})}catch(e){}}},auth:{flowType:"pkce"}})}function i(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL,r=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e||!r)throw Error("SUPABASE_SERVICE_ROLE_KEY ou URL n\xe3o configurados.");return(0,a.eI)(e,r,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var r=require("../../../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[276,786,702,972,67],()=>t(9906));module.exports=o})();