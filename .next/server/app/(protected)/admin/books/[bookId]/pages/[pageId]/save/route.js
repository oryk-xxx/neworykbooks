"use strict";(()=>{var e={};e.id=53,e.ids=[53],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},8352:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>x,patchFetch:()=>_,requestAsyncStorage:()=>m,routeModule:()=>g,serverHooks:()=>k,staticGenerationAsyncStorage:()=>l});var t={};o.r(t),o.d(t,{POST:()=>c});var s=o(9303),n=o(8716),a=o(670),i=o(7070),d=o(1067),p=o(748);let u=d.Ry({slug:d.Z_().min(2),order_index:d.oQ.number().min(1),content_json:d.Z_().min(2)});async function c(e,r){let o=(0,p.Lg)(),t=await e.formData(),s=u.safeParse({slug:String(t.get("slug")||""),order_index:Number(t.get("order_index")||"1"),content_json:String(t.get("content_json")||"")});if(!s.success)return i.NextResponse.redirect(new URL(`/admin/books/${r.params.bookId}/pages/${r.params.pageId}?error=invalid`,e.url));let n=s.data,a=JSON.parse(n.content_json),{data:d,error:c}=await o.from("pages").update({slug:n.slug,order_index:n.order_index,content:a}).eq("id",r.params.pageId).select("*").maybeSingle();return!d||c?i.NextResponse.redirect(new URL(`/admin/books/${r.params.bookId}/pages/${r.params.pageId}?error=save_failed`,e.url)):(await o.from("page_versions").insert({page_id:d.id,content:a}),i.NextResponse.redirect(new URL(`/admin/books/${r.params.bookId}/pages/${r.params.pageId}`,e.url)))}let g=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/(protected)/admin/books/[bookId]/pages/[pageId]/save/route",pathname:"/admin/books/[bookId]/pages/[pageId]/save",filename:"route",bundlePath:"app/(protected)/admin/books/[bookId]/pages/[pageId]/save/route"},resolvedPagePath:"C:\\Users\\kirit\\Documents\\GitHub\\neworykbooks\\src\\app\\(protected)\\admin\\books\\[bookId]\\pages\\[pageId]\\save\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:k}=g,x="/(protected)/admin/books/[bookId]/pages/[pageId]/save/route";function _(){return(0,a.patchFetch)({serverHooks:k,staticGenerationAsyncStorage:l})}},748:(e,r,o)=>{o.d(r,{JJ:()=>i,Lg:()=>a,i_:()=>d});var t=o(1615),s=o(344),n=o(7857);function a(){return(0,s.createRouteHandlerClient)({cookies:t.cookies})}function i(){return(0,s.createServerComponentClient)({cookies:t.cookies})}function d(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL,r=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e||!r)throw Error("SUPABASE_SERVICE_ROLE_KEY ou URL n\xe3o configurados.");return(0,n.eI)(e,r,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var r=require("../../../../../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[276,998,972,67],()=>o(8352));module.exports=t})();