(()=>{var e={};e.id=285,e.ids=[285],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},9079:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c}),s(1324),s(2029),s(5866);var t=s(3191),a=s(8716),n=s(7922),o=s.n(n),i=s(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(r,l);let c=["",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1324)),"C:\\Users\\kirit\\Documents\\GitHub\\neworykbooks\\src\\app\\checkout\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"C:\\Users\\kirit\\Documents\\GitHub\\neworykbooks\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\kirit\\Documents\\GitHub\\neworykbooks\\src\\app\\checkout\\page.tsx"],m="/checkout/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9852:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},5203:()=>{},5303:()=>{},1324:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>i});var t=s(9510),a=s(7848),n=s(748);async function o(){let e=await fetch(`${a.O.siteUrl}/api/payment/create`,{method:"POST",cache:"no-store"});if(!e.ok)throw Error("Falha ao criar pagamento PIX");return e.json()}async function i(){let e=(0,n.JJ)(),{data:{session:r}}=await e.auth.getSession(),s=r?(await e.from("entitlements").select("*").eq("user_id",r.user.id).maybeSingle()).data:null,a=s?.active===!0,i=r&&!a?await o():null;return(0,t.jsxs)("div",{className:"mx-auto max-w-2xl px-6 py-10",children:[t.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Pagamento PIX"}),t.jsx("p",{className:"text-xs text-zinc-400",children:"Acesso \xfanico e vital\xedcio \xe0 \xd8RYK Books. Valor: R$7."}),r?null:(0,t.jsxs)("div",{className:"mt-6 rounded-2xl border border-borderSubtle/80 bg-black/60 p-4 text-sm",children:[t.jsx("p",{className:"mb-2",children:"Fa\xe7a login para iniciar o pagamento. Usamos link m\xe1gico por e-mail."}),t.jsx("a",{href:"/login?redirectTo=/checkout",className:"inline-flex rounded-full border border-accent/60 bg-accent/10 px-4 py-2 text-xs text-accent",children:"Ir para login"})]}),r&&a?(0,t.jsxs)("div",{className:"mt-6 rounded-2xl border border-emerald-700/60 bg-emerald-950/40 p-4 text-sm text-emerald-50",children:[t.jsx("p",{className:"mb-2",children:"Acesso j\xe1 est\xe1 liberado para sua conta."}),t.jsx("a",{href:"/reader",className:"inline-flex rounded-full bg-emerald-500 px-4 py-2 text-xs font-medium text-black",children:"Ir para a biblioteca"})]}):null,r&&!a&&i?(0,t.jsxs)("div",{className:"mt-6 grid gap-6 md:grid-cols-[1fr_1fr]",children:[(0,t.jsxs)("div",{className:"rounded-2xl border border-borderSubtle/80 bg-black/60 p-4",children:[t.jsx("p",{className:"mb-2 text-[11px] uppercase tracking-[0.2em] text-zinc-500",children:"QR Code PIX"}),t.jsx("img",{src:`data:image/png;base64,${i.qr_code_base64}`,alt:"QR Code PIX",className:"mx-auto w-64 rounded-lg border border-borderSubtle/80"})]}),(0,t.jsxs)("div",{className:"rounded-2xl border border-borderSubtle/80 bg-black/60 p-4 text-xs",children:[t.jsx("p",{className:"mb-2 text-[11px] uppercase tracking-[0.2em] text-zinc-500",children:"Copia e cola"}),t.jsx("p",{className:"break-all rounded-lg border border-borderSubtle/80 bg-black/40 p-3 text-zinc-200",children:i.qr_code}),t.jsx("p",{className:"mt-3 text-zinc-400",children:"Ap\xf3s aprovado, seu acesso ser\xe1 liberado automaticamente. Esta p\xe1gina atualiza a cada 5 segundos."})]})]}):null,r&&!a&&i?t.jsx(l,{paymentId:i.id}):null]})}async function l({paymentId:e}){let r=await fetch(`${a.O.siteUrl}/api/payment/status?id=${e}`,{cache:"no-store"}),s=r.ok?await r.json():null,n=s?.status==="approved";return(s?.status,n)?(0,t.jsxs)("div",{className:"mt-6 rounded-2xl border border-emerald-700/60 bg-emerald-950/40 p-4 text-sm text-emerald-50",children:[t.jsx("p",{className:"mb-2",children:"Pagamento aprovado! Seu acesso est\xe1 liberado."}),t.jsx("a",{href:"/reader",className:"inline-flex rounded-full bg-emerald-500 px-4 py-2 text-xs font-medium text-black",children:"Ir para a biblioteca"})]}):t.jsx("meta",{httpEquiv:"refresh",content:"5"})}},2029:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>n,metadata:()=>a});var t=s(9510);s(5023);let a={title:"\xd8RYK Books",description:"Plataforma premium de leitura com foco em escrita refinada"};function n(e){return t.jsx("html",{lang:"pt-BR",className:"dark",children:(0,t.jsxs)("body",{className:"min-h-screen bg-background text-foreground",children:[t.jsx("div",{className:"fixed inset-0 pointer-events-none bg-[radial-gradient(circle_at_top,_rgba(123,92,255,0.35),_transparent_55%),radial-gradient(circle_at_bottom,_rgba(0,0,0,0.9),_transparent_55%)]"}),(0,t.jsxs)("div",{className:"relative min-h-screen flex flex-col",children:[t.jsx("header",{className:"border-b border-borderSubtle/60 bg-black/40 backdrop-blur-xl",children:(0,t.jsxs)("div",{className:"mx-auto flex max-w-5xl items-center justify-between px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[t.jsx("span",{className:"text-xl font-semibold tracking-[0.25em] uppercase",children:"\xd8RYK"}),t.jsx("span",{className:"text-sm text-zinc-400",children:"Books"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[t.jsx("span",{children:"Acesso vital\xedcio"}),t.jsx("span",{className:"h-4 w-px bg-zinc-700"}),t.jsx("span",{children:"R$7"})]})]})}),t.jsx("main",{className:"flex-1",children:e.children})]})]})})}},7848:(e,r,s)=>{"use strict";s.d(r,{O:()=>t});let t={siteUrl:process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000",supabaseUrl:process.env.NEXT_PUBLIC_SUPABASE_URL||"",supabaseAnonKey:process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",supabaseServiceRoleKey:process.env.SUPABASE_SERVICE_ROLE_KEY||"",mercadoPagoAccessToken:process.env.MERCADOPAGO_ACCESS_TOKEN||"",mercadoPagoWebhookSecret:process.env.MERCADOPAGO_WEBHOOK_SECRET||""}},748:(e,r,s)=>{"use strict";s.d(r,{JJ:()=>i,Lg:()=>o,i_:()=>l});var t=s(1615),a=s(344),n=s(7857);function o(){return(0,a.createRouteHandlerClient)({cookies:t.cookies})}function i(){return(0,a.createServerComponentClient)({cookies:t.cookies})}function l(){let e=process.env.NEXT_PUBLIC_SUPABASE_URL,r=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!e||!r)throw Error("SUPABASE_SERVICE_ROLE_KEY ou URL n\xe3o configurados.");return(0,n.eI)(e,r,{auth:{autoRefreshToken:!1,persistSession:!1}})}},5023:()=>{}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[276,998,471],()=>s(9079));module.exports=t})();